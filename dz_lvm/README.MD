# Домашняя работа по занятию "LVM"
Описание домашнего задания:
Что нужно сделать?
на имеющемся образе [centos/7 1804.2](https://gitlab.com/otus_linux/stands-03-lvm)

/dev/mapper/VolGroup00-LogVol00 38G 738M 37G 2% /

- уменьшить том под / до 8G
- выделить том под /home
- выделить том под /var (/var - сделать в mirror)
- для /home - сделать том для снэпшотов
- прописать монтирование в fstab (попробовать с разными опциями и разными файловыми системами на выбор)
Работа со снапшотами:
- сгенерировать файлы в /home/
- снять снэпшот
- удалить часть файлов
- восстановиться со снэпшота

---
Система загрузилась и разделы инициализированы:
![1](./images/1.png)

## Уменьшить том под / до 8G 
Создан и подмонтирован временный root раздел на новой volume group
![2](./images/2.png)

Средством xfsdump перенесены данные с root раздела 
![3](./images/3.png)

Затем сконфигурируем grub для того, чтобы при старте перейти в новый /.
![4](./images/4.png)

Выполняем chroot на временный раздел и редактируем загрузку на новый volume_group 
![5](./images/5.png)

Корень смонтировался на временный раздел 
![6](./images/6.png)

Пересоздаем старую VG на 8 гигабайт, и проделываем действия с переносом назад. 

## Выделить том под /var (/var - сделать в mirror)
Определяем sdc и sdd как Physical volumes, создаем на них новый Volume group и Logical Volume.
![11](./images/11.png)

Записываем данные в fstab 
```bash
echo "`blkid | grep var: | awk '{print $2}'` \
>  /var ext4 defaults 0 0" >> /etc/fstab
```
Перезагружаемся, корень смонитрован на 8 гигабайтный раздел, /var также смонтирован на новый lv. Удаляем временные сущности.
![8](./images/8.png)

# Для /home - сделать том для снэпшотов
Создаем новый logical volume и монтируем его в /home. Записываем параметры в fstab 
![12](./images/12.png)

Наполняем том данными, создаем снапшот и проверяем удаление файлов и восстановление снапшота
![9](./images/9.png)

## Итог 
Итоговый вывод `lsblk` и вид `/etc/fstab`
![10](./images/10.png)